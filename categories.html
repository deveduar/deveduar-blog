---
layout: page
title: Categories
permalink: /categories/
---

<div class="categories-page">
  <p class="categories-intro">Browse all posts by category:</p>
  
  <div class="categories-cloud">
    {% assign sorted_categories = site.categories | sort %}
    <a href="#all" class="category-cloud-item category-filter active" data-category="all">
      All <span class="category-count">({{ site.posts.size }})</span>
    </a>
    {% for category in sorted_categories %}
      {% assign category_size_class = category[1].size | divided_by: 5 | plus: 1 %}
      {% if category_size_class > 5 %}{% assign category_size_class = 5 %}{% endif %}
      <a href="#{{ category[0] | slugify }}" class="category-cloud-item category-filter category-size-{{ category_size_class }}" data-category="{{ category[0] | slugify }}">
        {{ category[0] }} <span class="category-count">({{ category[1].size }})</span>
      </a>
    {% endfor %}
  </div>
  
  <div class="category-filter-container">
    <div class="category-posts-grid">
      {% assign all_posts = site.posts | sort: 'date' | reverse %}
      {% for post in all_posts %}
        <div class="category-post-card" data-categories="{% for cat in post.categories %}{{ cat | slugify }} {% endfor %}">
          <div class="category-post-meta">
            <span class="post-date">{{ post.date | date: "%b %-d, %Y" }}</span>
            
            {% if post.categories.size > 0 %}
            <div class="post-categories">
              {% for cat in post.categories %}
                <a class="category-badge" href="#{{ cat | slugify }}" data-filter="{{ cat | slugify }}">{{ cat }}</a>
              {% endfor %}
            </div>
            {% endif %}
          </div>
          
          <h3 class="post-title">
            <a href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
          </h3>
          
          <div class="post-excerpt">
            {{ post.excerpt | strip_html | truncatewords: 30 }}
          </div>
          
          {% if post.tags.size > 0 %}
          <div class="post-tags">
            {% for tag in post.tags %}
              <a class="tag-badge" href="/tags#{{ tag | slugify }}">#{{ tag }}</a>
            {% endfor %}
          </div>
          {% endif %}
          
          <a href="{{ post.url | relative_url }}" class="read-more-link">Read more â†’</a>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
    // Function to handle category filtering
    function initCategoryFiltering() {
      const filterLinks = document.querySelectorAll('.category-filter');
      const postCards = document.querySelectorAll('.category-post-card');
      const categoryBadges = document.querySelectorAll('.category-badge');
      const filterContainer = document.querySelector('.category-filter-container');
      
      // Function to filter posts
      function filterPosts(category) {
        if (filterContainer) filterContainer.classList.add('loading');
        
        // Force browser to recognize style changes
        void filterContainer.offsetWidth;
        
        if (category === 'all') {
          postCards.forEach(card => {
            card.style.display = 'flex';
          });
        } else {
          postCards.forEach(card => {
            if (card.dataset.categories.includes(category)) {
              card.style.display = 'flex';
            } else {
              card.style.display = 'none';
            }
          });
        }
        
        if (filterContainer) filterContainer.classList.remove('loading');
      }
      
      // Function to apply filter from hash
      function applyFilterFromHash() {
        // Get category from hash (remove the # symbol)
        let category = window.location.hash.substring(1);
        
        // If no category or empty hash, use 'all'
        if (!category) {
          category = 'all';
        }
        
        console.log("Applying filter for category:", category);
        
        // Find the corresponding filter link
        const filterLink = document.querySelector(`.category-filter[data-category="${category}"]`);
        
        if (filterLink) {
          // Remove active class from all links
          filterLinks.forEach(l => l.classList.remove('active'));
          
          // Add active class to the target link
          filterLink.classList.add('active');
          
          // Filter posts
          filterPosts(category);
        } else {
          console.log("Filter link not found for category:", category);
        }
      }
      
      // Set active class and filter posts when clicking on category in cloud
      filterLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Get category from data attribute
          const category = this.dataset.category;
          
          // Update URL hash without scrolling
          history.pushState(null, null, category === 'all' ? '#' : '#' + category);
          
          // Apply the filter
          applyFilterFromHash();
        });
      });
      
      // Filter by category badge clicks
      categoryBadges.forEach(badge => {
        badge.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Get category from data attribute
          const category = this.dataset.filter;
          
          // Update URL hash without page jump
          history.pushState(null, null, '#' + category);
          
          // Apply filter manually instead of relying on hashchange
          applyFilterFromHash();
        });
      });
      
      // Apply filter when hash changes (works with browser back/forward buttons too)
      window.addEventListener('hashchange', applyFilterFromHash);
      
      // Apply filter on initial page load
      applyFilterFromHash();
    }
  
    // Initialize on DOMContentLoaded for regular page loads
    document.addEventListener('DOMContentLoaded', initCategoryFiltering);
    
    // Initialize with InstantClick if available
    if (typeof InstantClick !== 'undefined') {
      InstantClick.on('change', function() {
        console.log("InstantClick change event triggered");
        // Short delay to ensure DOM is updated
        setTimeout(initCategoryFiltering, 50);
      });
    }
  </script>